spring:
  application:
    name: transaction-app

  datasource:
    url: jdbc:postgresql://localhost:3307/sharding_db
    username: ${DB_USER:sharding_user}
    password: ${DB_PASSWORD}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 20
      connection-timeout: 30000
      validation-timeout: 5000
      idle-timeout: 600000
      max-lifetime: 1800000
      pool-name: WalletHikariPool
      initialization-fail-timeout: 1
      connection-test-query: SELECT 1
      leak-detection-threshold: 60000

  jpa:
    hibernate:
      ddl-auto: validate
      naming:
        physical-strategy: org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        jdbc:
          time_zone: UTC
        generate_statistics: false
        show_sql: false
        format_sql: false
        hbm2ddl:
          auto: validate
    open-in-view: false
    defer-datasource-initialization: false

  flyway:
    enabled: false

  # Кастомные настройки для шардирования
  wallet:
    sharding:
      enabled: true
      shard-count: 2
      broadcast-tables: wallet_types

management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus
  endpoint:
    health:
      show-details: when_authorized
    prometheus:
      access: read_only
  metrics:
    tags:
      application: ${spring.application.name}
      environment: ${ENV:development}
    export:
      prometheus:
        enabled: true

  tracing:
    enabled: true
    sampling:
      probability: 1.0

otel:
  exporter:
    otlp:
      endpoint: ${OTLP_EXPORTER_ENDPOINT:http://localhost:4318}
      protocol: http/protobuf
  logs:
    exporter: none
  metrics:
    exporter: none

logging:
  config: "classpath:logback.xml"
  level:
    org.apache.shardingsphere: INFO
    org.springframework.jdbc: WARN
    org.hibernate.SQL: WARN
    com.zaxxer.hikari: INFO

individuals:
  api:
    url: http://localhost:8081/api/v1
    connect-timeout: 5000
    read-timeout: 10000